{% load dict_extras %}

{% for venue, gigs in gigs_by_venue.items %}
  <div class="board-column" style="flex: 0 0 300px; background: #e6f3ff; border-radius: 6px; padding: 10px;">
    <h5 class="text-center">{{ venue.name }}</h5>

    {% for gig in gigs %}
      <a href="{% url 'gigs:performer_gig_grid_detail' gig.id %}" style="text-decoration: none; color: inherit;">
        <div class="gig-card" style="background-color: #ffffff; border-radius: 8px; padding: 10px; margin-bottom: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.1s ease;">

          {% if venue.image %}
            <img src="{{ venue.image.url }}" alt="{{ venue.name }}" style="width: 100%; border-radius: 6px; margin-bottom: 8px;">
          {% endif %}

          <table style="width: 100%;">
            <tr>
              <td style="width: 85%;">
                <div class="fw-bold text-dark">{{ gig.title }}</div>
              </td>
              <td rowspan="2" style="width: 15%; text-align: right; vertical-align: middle;">
                {% with status=my_availability|get_item:gig.id %}
                  {% if status == "Y" %}
                      <span class="badge bg-success">Y</span>
                  {% elif status == "N" %}
                      <span class="badge bg-danger">N</span>
                  {% elif status == "M" %}
                      <span class="badge bg-warning text-dark">M</span>
                  {% else %}
                      <span class="badge bg-secondary">â€“</span>
                  {% endif %}
                {% endwith %}
              </td>
            </tr>
            <tr>
              <td>
                <small class="text-muted">
                  {{ gig.date|date:"M d, Y" }}
                  {% if gig.start_time %}
                    {{ gig.start_time|time:"H:i" }}
                    {% if gig.end_time %}
                      - {{ gig.end_time|time:"H:i" }}
                    {% endif %}
                  {% endif %}
                </small>
              </td>
            </tr>
          </table>

        </div>
      </a>
    {% endfor %}
  </div>
{% endfor %}
