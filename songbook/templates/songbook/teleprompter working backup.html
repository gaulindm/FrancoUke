{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ song.title }}</title>
  <link rel="stylesheet" href="{% static 'songbook/css/teleprompter.css' %}">
  


  <!-- Diagram renderer -->
  <script src="{% static 'songbook/js/chord_diagrams.js' %}"></script>
  <!-- Teleprompter engine -->
  <script src="{% static 'songbook/js/teleprompter.js' %}"></script>
</head>
<body>
  <!-- Controls -->
  <div class="controls">
    <div class="left">
      <span class="song-title">{{ song.title }}</span>
      <button id="toggle-chords">Hide Chords</button>
    </div>
    <div class="center">
      <button id="scroll-toggle">▶️ Start</button>
      <div class="control-inline">
        Speed: <input type="range" id="scroll-speed" min="1" max="10" value="3">
      </div>
    </div>
    <div class="right">
      <button id="scroll-reset">⏹ Reset</button>
    </div>
  </div>

  <!-- Lyrics -->
  <div class="tp-main">
    <div class="lyrics-container">
      <div class="lyrics">
        <div class="metadata">
          <h1>{{ song.title }}</h1>
          {% if metadata.songwriter %}
            <div class="songwriter">{{ metadata.songwriter }}</div>
          {% endif %}
          {% if metadata.artist %}
            <div class="recording">
              {{ metadata.artist }}{% if metadata.year %} ({{ metadata.year }}){% endif %}
            </div>
          {% endif %}
        </div>
        {{ lyrics_with_chords|safe }}
      </div>
    </div>
  </div>

  <!-- Chords data -->
  <script id="chords-data" type="application/json">
    {{ relevant_chords_json|safe }}
  </script>

  <!-- Chord Section -->
  <div id="chord-section">
    <div id="chord-diagrams"></div>
  </div>

  <!-- Initialize SONG -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      window.SONG = {
        id: "{{ song.id }}",
        title: "{{ song.title|escapejs }}",
        initialTranspose: 0,
        chords: JSON.parse(document.getElementById("chords-data").textContent)
      };
      console.log("✅ SONG loaded:", window.SONG);
    });
  </script>
</body>
</html>